<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcial Final: Caso Luis Fernando y Herederos</title>
    
    <!-- React y ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para interpretar JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Estilos -->
    <style>
        .custom-scrollbar::-webkit-scrollbar { height: 8px; width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans h-screen flex flex-col overflow-hidden">
    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- ICONOS ---
        const Icons = {
            FileText: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
            Users: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Scale: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>,
            AlertTriangle: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
            ShieldAlert: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>,
            Gavel: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m14 13-7.5 7.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L11 10"/><path d="m16 16 6-6"/><path d="m8 8 6-6"/><path d="m9 7 8 8"/><path d="m21 11-8-8"/></svg>,
            ArrowRight: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>,
            BookOpen: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            HelpCircle: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>,
            CheckCircle: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            XCircle: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>,
            Map: ({size}) => <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></svg>
        };

        // --- COMPONENTE 1: VISTA DE ANÁLISIS DEL CASO (Principal) ---
        const CaseAnalysisView = ({ navigateToMap }) => {
            const qaData = [
                {
                    category: "Familia y Sucesiones",
                    color: "blue",
                    items: [
                        { q: "a) ¿Debe liquidarse primero la unión marital o la sucesión?", a: "Primero la Unión Marital. No se puede heredar lo que no pertenece al causante. Se deben separar los gananciales (50% MPT) de la herencia (50% LF). (Sentencia SC005-2021)." },
                        { q: "b) ¿Qué efectos produce la muerte presunta en la sociedad patrimonial?", a: "Disuelve automáticamente la sociedad patrimonial de hecho (Ley 54/1990 Art 5). Fija la fecha presuntiva de muerte." },
                        { q: "h) ¿Es procedente hoy la interdicción de la hija con discapacidad?", a: "NO. La Ley 1996 de 2019 abolió la interdicción. Se debe solicitar 'Adjudicación de Apoyos' para la toma de decisiones." },
                        { q: "m) ¿Cuándo procede el proceso divisorio?", a: "Es subsidiario. Procede solo si tras la sucesión quedan como comuneros y no hay acuerdo. Lo ideal es la partición dentro de la sucesión." },
                        { q: "n) ¿Puede acumularse con la sucesión?", a: "La liquidación de la sociedad conyugal SI se acumula. El divisorio NO, la partición lo suple." }
                    ]
                },
                {
                    category: "Derecho Bancario y Deudas",
                    color: "red",
                    items: [
                        { q: "c) ¿Tiene prelación el Banco frente a los herederos?", a: "SÍ. La hipoteca es una garantía real con preferencia (Crédito de 3ra clase, Art. 2499 C.C.). El banco cobra primero." },
                        { q: "d) ¿Puede adelantarse el remate mientras se tramita la sucesión?", a: "SÍ. La acción real persigue el bien. ESTRATEGIA: Alegar Nulidad por indebida notificación (demandaron a un muerto)." },
                        { q: "e) ¿Puede suspenderse el remate por existencia de menor heredero?", a: "NO. Las deudas no desaparecen por minoría de edad. El patrimonio responde." },
                        { q: "o) ¿Puede venderse antes del remate hipotecario?", a: "SÍ, pero condicionado. Se debe pagar al banco para levantar embargo O que el comprador asuma la deuda con autorización del juez/banco (Art. 1521 C.C.)." }
                    ]
                },
                {
                    category: "Alimentos y Menores",
                    color: "purple",
                    items: [
                        { q: "i) ¿La emancipación de Julián extingue la obligación alimentaria?", a: "NO necesariamente. Si persiste la necesidad, se deben alimentos hasta los 25 años (si estudia) o de por vida (si hay discapacidad)." },
                        { q: "j) ¿Procede aumento de alimentos después de la muerte presunta?", a: "NO aumento futuro (el causante murió). Procede el cobro RETROACTIVO como deuda de la herencia." },
                        { q: "k) ¿Qué criterios usa el juez para fijar alimentos?", a: "1. Necesidad del alimentario. 2. Capacidad del alimentante (Masa Sucesoral). 3. Posición social (Congruos vs Necesarios)." }
                    ]
                },
                {
                    category: "Bienes y Civil",
                    color: "green",
                    items: [
                        { q: "f) Diferencie bien vacante y mostrenco.", a: "Vacante: Inmueble (Lote) sin dueño conocido. Mostrenco: Mueble (Maquinaria) abandonado." },
                        { q: "g) ¿Puede la Alcaldía apropiarse directamente del lote?", a: "NO directamente. Requiere proceso judicial para declarar la vacancia y adjudicarlo (ICBF o Fondo de Tierras)." },
                        { q: "l) ¿Qué requisitos exige la servidumbre judicial de tránsito?", a: "1. Predio destituido de comunicación (enclavado). 2. Indispensable para el uso. 3. Indemnización al predio sirviente (Art. 905 C.C.)." }
                    ]
                }
            ];

            return (
                <div className="flex-1 overflow-y-auto bg-white p-4 md:p-8 custom-scrollbar fade-in">
                    <div className="max-w-5xl mx-auto space-y-8">
                        
                        {/* Header del Caso */}
                        <div className="bg-slate-900 text-white p-6 rounded-2xl shadow-xl border-l-8 border-yellow-500">
                            <h2 className="text-2xl font-bold mb-2">Caso: Luis Fernando y Herederos</h2>
                            <p className="opacity-80">Parcial Final • Derecho Procesal Civil General</p>
                            <div className="mt-4 flex gap-4">
                                <button onClick={navigateToMap} className="bg-yellow-500 text-slate-900 px-4 py-2 rounded-lg font-bold hover:bg-yellow-400 transition flex items-center gap-2 shadow-lg">
                                    <Icons.Map size={20} /> Ir al Mapa Interactivo
                                </button>
                            </div>
                        </div>

                        {/* Hechos y Problema */}
                        <div className="grid md:grid-cols-2 gap-6">
                            <div className="bg-slate-50 p-6 rounded-xl border border-slate-200 shadow-sm">
                                <h3 className="text-lg font-bold text-slate-800 mb-3 flex items-center gap-2">
                                    <Icons.FileText size={20} className="text-blue-600"/> Hechos Relevantes
                                </h3>
                                <ul className="list-disc list-inside space-y-2 text-sm text-slate-700">
                                    <li>Convivencia LF y MPT (20 años). Hacienda a nombre de LF.</li>
                                    <li>Hijos: Julián (Extramatrimonial, emancipado) y Hija Mayor (Discapacidad).</li>
                                    <li>Desaparición 2019 → <strong>Muerte Presunta 2021</strong>.</li>
                                    <li>Patrimonio: Hacienda (Hipoteca $800M), Lote (Posesión), Maquinaria.</li>
                                </ul>
                            </div>
                            <div className="bg-red-50 p-6 rounded-xl border border-red-200 shadow-sm">
                                <h3 className="text-lg font-bold text-red-800 mb-3 flex items-center gap-2">
                                    <Icons.AlertTriangle size={20} className="text-red-600"/> Problema Jurídico
                                </h3>
                                <p className="text-sm text-slate-700 mb-2">
                                    Conflicto multifactorial entre la liquidación patrimonial familiar y la ejecución de acreedores.
                                </p>
                                <p className="text-sm font-bold text-red-700">
                                    Tensión Principal: El Banco Agrario inició remate desconociendo la muerte de LF vs. Derechos de herederos y compañera permanente.
                                </p>
                            </div>
                        </div>

                        {/* Resolución por Bloques */}
                        <div>
                            <h3 className="text-xl font-bold text-slate-800 mb-6 pb-2 border-b border-slate-200">
                                Resolución por Bloques Conceptuales
                            </h3>
                            <div className="grid md:grid-cols-2 gap-6">
                                {qaData.map((block, idx) => (
                                    <div key={idx} className={`rounded-xl border-t-4 bg-white shadow-md p-5 border-${block.color}-500`}>
                                        <h4 className={`text-${block.color}-700 font-bold mb-4 uppercase tracking-wide text-sm`}>
                                            {block.category}
                                        </h4>
                                        <div className="space-y-4">
                                            {block.items.map((item, i) => (
                                                <div key={i} className="bg-slate-50 p-3 rounded border border-slate-100">
                                                    <p className="text-xs font-semibold text-slate-500 mb-1">{item.q}</p>
                                                    <p className="text-sm text-slate-800 font-medium leading-relaxed">{item.a}</p>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        // --- COMPONENTE 2: MAPA INTERACTIVO (Timeline) ---
        const TimelineMap = () => {
             const [selectedNode, setSelectedNode] = useState(null);
          
              const stages = [
                {
                  id: 'etapa1',
                  title: 'ETAPA 1: HECHO GENERADOR',
                  nodes: [
                    {
                      id: '1',
                      title: 'Sentencia Muerte Presunta (2021)',
                      type: 'origen',
                      icon: <Icons.FileText size={20} />,
                      desc: 'Punto de partida jurídico.',
                      details: {
                        ley: 'C.C. Art. 97; CGP Art. 584',
                        hecho: 'Luis Fernando desaparece en 2019. Sentencia en 2021.',
                        estrategia: 'Fija la fecha de muerte. Sin esto no hay sucesión ni liquidación. Disuelve la sociedad patrimonial automáticamente.'
                      }
                    }
                  ]
                },
                {
                  id: 'etapa2',
                  title: 'ETAPA 2: PREJUDICIALIDAD',
                  nodes: [
                    {
                      id: '2',
                      title: 'Declaración U.M.H.',
                      type: 'familia',
                      category: 'Requisito Previo',
                      icon: <Icons.Users size={20} />,
                      desc: 'María Patricia vs Herederos',
                      details: {
                        ley: 'Ley 54/1990; Ley 979/2005; Sentencia SC005-2021',
                        hecho: '20 años de convivencia.',
                        estrategia: 'OBLIGATORIO. Primero se declara la unión, luego se liquida. Separa el 50% de MPT (sus gananciales) del 50% de LF (herencia).'
                      }
                    },
                    {
                      id: '3',
                      title: 'Proceso Ejecutivo (Banco)',
                      type: 'banco',
                      category: 'Riesgo Inminente',
                      icon: <Icons.AlertTriangle size={20} />,
                      desc: 'Cobro Hipoteca $800M',
                      details: {
                        ley: 'C.C. Art. 2432 (Garantía Real)',
                        hecho: 'Banco Agrario inicia cobro sin saber de la muerte.',
                        estrategia: 'El Banco tiene prelación. No necesita esperar la sucesión para perseguir la finca. Riesgo de remate.'
                      }
                    }
                  ]
                },
                {
                  id: 'etapa3',
                  title: 'ETAPA 3: SUCESIÓN Y DEFENSA',
                  nodes: [
                    {
                      id: '4',
                      title: 'Sucesión Intestada',
                      type: 'familia',
                      category: 'Proceso Universal',
                      icon: <Icons.Scale size={20} />,
                      desc: 'Repartición de Bienes',
                      details: {
                        ley: 'CGP Art. 487 y ss.',
                        hecho: 'Entra el 50% de LF. Herederos: Julián y Hija Mayor.',
                        estrategia: 'Aquí se pagan las deudas (alimentos, banco) y se adjudican los remanentes. La partición hace las veces de división.'
                      }
                    },
                    {
                      id: '5',
                      title: 'Nulidad Procesal',
                      type: 'banco',
                      category: 'Defensa Clave',
                      icon: <Icons.ShieldAlert size={20} />,
                      desc: 'Frenar al Banco',
                      details: {
                        ley: 'CGP Art. 53 (Capacidad); CGP Art. 133 #8 (Notificación)',
                        hecho: 'Banco demandó a un muerto.',
                        estrategia: 'ESTRATEGIA GANADORA: Solicitar nulidad por indebida notificación a herederos. Objetivo: Ganar tiempo para cobrar seguro.'
                      }
                    }
                  ]
                },
                {
                  id: 'etapa4',
                  title: 'ETAPA 4: INCIDENTES (RESOLUCIÓN)',
                  nodes: [
                    {
                      id: '6',
                      title: 'Incidente: Alimentos',
                      type: 'incidente',
                      category: 'Deuda Hereditaria',
                      icon: <Icons.Gavel size={20} />,
                      desc: 'Julián (Retroactivos)',
                      details: {
                        ley: 'C.C. Art. 411 y 422; Sentencia T-188 de 2023',
                        hecho: 'Julián pide alimentos desde los 16 años.',
                        estrategia: 'Se pagan como DEUDA de la sucesión (retroactivos). No hay aumento futuro tras la muerte.'
                      }
                    },
                    {
                      id: '7',
                      title: 'Incidente: Discapacidad',
                      type: 'incidente',
                      category: 'Capacidad Legal',
                      icon: <Icons.BookOpen size={20} />,
                      desc: 'Hija Mayor (Apoyos)',
                      details: {
                        ley: 'Ley 1996 de 2019; Sentencia C-025 de 2021',
                        hecho: 'Discapacidad cognitiva severa.',
                        estrategia: 'NO interdicción. Se solicita adjudicación de APOYOS para la toma de decisiones.'
                      }
                    },
                    {
                      id: '8',
                      title: 'Cobro Seguro Vida',
                      type: 'banco',
                      category: 'Solución Final',
                      icon: <Icons.CheckCircle size={20} />,
                      desc: 'Extinción Deuda',
                      details: {
                        ley: 'Contrato de Seguros',
                        hecho: 'Crédito hipotecario tiene seguro de vida.',
                        estrategia: 'Si prospera la nulidad y se prueba la muerte, la aseguradora paga al Banco. La finca queda libre para herederos.'
                      }
                    },
                    {
                      id: '9',
                      title: 'Bienes Vacantes/Servidumbre',
                      type: 'incidente',
                      category: 'Saneamiento',
                      icon: <Icons.HelpCircle size={20} />,
                      desc: 'Lote y Vía',
                      details: {
                        ley: 'C.C. Art. 706 (Vacantes); C.C. Art. 905 (Servidumbre)',
                        hecho: 'Lote sin dueño y Finca sin vía.',
                        estrategia: 'El lote podría perderse ante el Estado (ICBF). La servidumbre es necesaria para valorizar la finca.'
                      }
                    }
                  ]
                }
              ];

            const getStyle = (type) => {
                switch(type) {
                  case 'origen': return 'border-slate-400 bg-slate-50 hover:bg-slate-100';
                  case 'familia': return 'border-blue-400 bg-blue-50 hover:bg-blue-100';
                  case 'banco': return 'border-red-400 bg-red-50 hover:bg-red-100';
                  case 'incidente': return 'border-purple-400 bg-purple-50 hover:bg-purple-100';
                  default: return 'border-gray-200 bg-white';
                }
            };
            const getIndicatorColor = (type) => {
                switch(type) {
                  case 'origen': return 'bg-slate-500';
                  case 'familia': return 'bg-blue-500';
                  case 'banco': return 'bg-red-500';
                  case 'incidente': return 'bg-purple-500';
                  default: return 'bg-gray-300';
                }
            };

            return (
                <div className="flex flex-col h-full bg-slate-50 fade-in relative">
                    {/* Scrolling Map Area */}
                    <div className="flex-1 overflow-x-auto overflow-y-hidden relative custom-scrollbar bg-slate-100/50">
                        <div className="min-w-max h-full p-8 flex gap-12 items-center">
                             {stages.map((stage, index) => (
                                <div key={stage.id} className="relative h-full flex flex-col justify-center min-w-[300px]">
                                  <div className="absolute top-4 left-0 w-full text-center border-b-2 border-slate-300 pb-2 mb-4">
                                    <h3 className="text-sm font-bold text-slate-500 tracking-widest">{stage.title}</h3>
                                  </div>
                                  <div className="flex flex-col gap-6 pt-12">
                                    {stage.nodes.map(node => (
                                      <div 
                                        key={node.id}
                                        onClick={() => setSelectedNode(node)}
                                        className={`
                                          w-72 p-4 rounded-xl border-l-4 shadow-sm cursor-pointer transition-all duration-200 relative group
                                          ${getStyle(node.type)}
                                          ${selectedNode?.id === node.id ? 'scale-105 shadow-md ring-2 ring-slate-800 z-10' : 'hover:-translate-y-1 hover:shadow-md'}
                                        `}
                                      >
                                        <div className={`absolute -left-[22px] top-1/2 w-4 h-[2px] ${getIndicatorColor(node.type)} opacity-30`}></div>
                                        <div className={`absolute -left-[26px] top-1/2 -translate-y-1/2 w-3 h-3 rounded-full ${getIndicatorColor(node.type)}`}></div>
                                        <div className="flex items-start gap-3">
                                          <div className={`mt-1 p-1.5 rounded-lg bg-white/60 text-slate-700`}>{node.icon}</div>
                                          <div>
                                            <h4 className="font-bold text-sm leading-tight text-slate-800">{node.title}</h4>
                                            <p className="text-xs text-slate-500 mt-1">{node.desc}</p>
                                          </div>
                                        </div>
                                      </div>
                                    ))}
                                  </div>
                                  {index < stages.length - 1 && (
                                    <div className="absolute right-[-24px] top-1/2 transform -translate-y-1/2 z-0 opacity-20">
                                      <Icons.ArrowRight size={40} className="text-slate-400" />
                                    </div>
                                  )}
                                </div>
                              ))}
                        </div>
                    </div>

                    {/* Bottom Detail Panel */}
                    <div className={`bg-white border-t-4 border-slate-200 shadow-[0_-5px_20px_rgba(0,0,0,0.1)] transition-all duration-300 ease-in-out ${selectedNode ? 'h-72' : 'h-12'} shrink-0 z-20`}>
                        {selectedNode ? (
                          <div className="h-full flex flex-col">
                            <div className="flex justify-between items-center px-6 py-3 bg-slate-100 border-b border-slate-200">
                              <div className="flex items-center gap-3">
                                 <span className={`p-1 rounded ${
                                    selectedNode.type === 'familia' ? 'bg-blue-100 text-blue-600' :
                                    selectedNode.type === 'banco' ? 'bg-red-100 text-red-600' :
                                    selectedNode.type === 'incidente' ? 'bg-purple-100 text-purple-600' : 'bg-slate-200 text-slate-600'
                                 }`}>
                                   {selectedNode.icon}
                                 </span>
                                 <h2 className="font-bold text-lg">{selectedNode.title}</h2>
                                 <span className="text-xs px-2 py-1 rounded-full border border-slate-300 text-slate-500">{selectedNode.category}</span>
                              </div>
                              <button onClick={() => setSelectedNode(null)} className="text-slate-400 hover:text-slate-700">
                                <Icons.XCircle size={24} />
                              </button>
                            </div>
                            
                            <div className="p-6 grid grid-cols-1 md:grid-cols-3 gap-6 overflow-y-auto">
                              <div className="space-y-2">
                                <h4 className="font-bold text-xs uppercase text-slate-400 flex items-center gap-2"><Icons.BookOpen size={14} /> Fundamento Legal</h4>
                                <p className="text-sm font-mono bg-slate-50 p-2 rounded border border-slate-200 text-slate-700">
                                  {selectedNode.details.ley}
                                </p>
                              </div>
                              <div className="space-y-2">
                                <h4 className="font-bold text-xs uppercase text-slate-400 flex items-center gap-2"><Icons.FileText size={14} /> Hechos del Caso</h4>
                                <p className="text-sm text-slate-600 italic border-l-2 border-slate-300 pl-3">
                                  "{selectedNode.details.hecho}"
                                </p>
                              </div>
                              <div className="space-y-2">
                                <h4 className="font-bold text-xs uppercase text-slate-400 flex items-center gap-2"><Icons.Gavel size={14} /> Estrategia / Análisis</h4>
                                <p className="text-sm font-medium text-slate-800 bg-yellow-50 p-3 rounded border border-yellow-200">
                                  {selectedNode.details.estrategia}
                                </p>
                              </div>
                            </div>
                          </div>
                        ) : (
                          <div className="h-full flex items-center justify-center text-slate-400 gap-2 cursor-pointer hover:text-slate-600" onClick={() => {}}>
                            <span className="rotate-[-90deg]"><Icons.ArrowRight size={16} /></span>
                            <span className="text-sm font-medium">Selecciona una tarjeta arriba para ver los detalles jurídicos</span>
                          </div>
                        )}
                    </div>
                </div>
            );
        };

        // --- APP PRINCIPAL ---
        const App = () => {
            const [view, setView] = useState('analysis'); // 'analysis' or 'map'

            return (
                <>
                    <nav className="bg-slate-900 text-white shadow-lg shrink-0 z-30 relative">
                        <div className="max-w-7xl mx-auto px-4">
                            <div className="flex items-center justify-between h-16">
                                <div className="flex items-center gap-2 font-bold text-lg">
                                    <Icons.Scale className="text-yellow-400" size={24} />
                                    <span>Parcial Derecho Procesal</span>
                                </div>
                                <div className="flex gap-2 bg-slate-800 p-1 rounded-lg">
                                    <button 
                                        onClick={() => setView('analysis')}
                                        className={`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${view === 'analysis' ? 'bg-slate-600 text-white shadow' : 'text-slate-400 hover:text-white'}`}
                                    >
                                        Caso y Conceptos
                                    </button>
                                    <button 
                                        onClick={() => setView('map')}
                                        className={`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${view === 'map' ? 'bg-blue-600 text-white shadow' : 'text-slate-400 hover:text-white'}`}
                                    >
                                        Mapa Interactivo
                                    </button>
                                </div>
                            </div>
                        </div>
                    </nav>

                    <main className="flex-1 relative overflow-hidden">
                        {view === 'analysis' ? (
                            <CaseAnalysisView navigateToMap={() => setView('map')} />
                        ) : (
                            <TimelineMap />
                        )}
                    </main>
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>